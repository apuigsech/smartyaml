# Microservice deployment schema
properties:
  deployment:
    type: object
    properties:
      type:
        const: "microservice"
      replicas:
        type: integer
        minimum: 2
        maximum: 50
      resources:
        type: object
        properties:
          cpu:
            type: string
            pattern: "^\\d+m$"
          memory:
            type: string  
            pattern: "^\\d+Mi$"
        required: [cpu, memory]
      autoscaling:
        type: object
        properties:
          enabled:
            type: boolean
          min_replicas:
            type: integer
            minimum: 1
          max_replicas:
            type: integer
            minimum: 2
        required: [enabled]
    required: [type, replicas, resources]
required: [deployment]